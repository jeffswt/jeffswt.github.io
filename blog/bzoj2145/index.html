<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="theme-color" content="#292d35">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>bzoj2145: 悄悄话&nbsp;&nbsp;|&nbsp;&nbsp;jeffswt: the ac moments</title>
  <link rel="shortcut icon" href="/assets/images/favicon.png">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/font-awesome.css">
  <link rel="stylesheet" href="/assets/katex/katex.css">
  <link rel="stylesheet" href="/assets/gitment/gitment.css">
</head>

<body>
  <div class="topbar">
    <div class="bar">
      <span class="avatar-icon"><svg version="1.1" height="40px" version="1.1" viewBox="0 0 48 48" width="40px">
        <polygon points="-0.5,16 -0.5,37 0.5,34 0.5,32 1.5,28.8 1.5,24 1.5,21 2.5,17.6 2.5,16 1,14.9 "/>
        <polygon points="44,0.5 45,0.5 46.1,1.1 46.9,1.9 47.2,2.8 47.5,4.8 47.5,7 48,43.8 47.6,45.8 46.4,47.6
        	44.8,48.5 38,48.5 36.8,47.2 36.1,46.1 34.2,44.7 32.6,43.5 31.1,40.8 29.5,38.8 27.8,35.9 26.9,35.4 29.5,35.3 32.7,28.4
        	31.4,27.8 28.7,33.8 26.9,34.1 25.7,33.3 23.5,33.4 21,32.8 19.3,32.2 18.3,30.4 17.3,27.3 19.3,27.9 20.8,26.6 20.4,25.3 21.3,24
        	22.2,23 20.3,21.3 17.8,20.8 16.2,21.5 15.5,23 15.5,25 14.4,26 12.8,26.6 11.2,29.2 10.6,31.1 11.2,34.3 10.9,37.7 11,39.5
        	11.8,42.3 9.5,39.6 8.6,37 7.8,35.1 7.1,33.4 6.6,31 6,28.1 5.6,23.5 6.2,21.8 5.6,19.3 6.3,18.1 8.4,17 10.8,14.5 13,14.5
        	15.8,16.5 19,16.5 22.2,14.3 24,15 25.4,13.5 29,13.5 32.3,12.3 34.5,11.3 36,10.5 36.4,9 39.3,8.8 40.1,7.5 42,7.5 43.6,6.9
        	44,5.3 44.8,3.9 45.2,2.7 "/>
        <polygon points="17.5,34 17.5,37 18.2,37.5 22.8,35.4 21.1,34.7 17.9,34 "/>
        <polygon points="19,43.1 20.6,42.4 22.1,41.4 24,39.5 25,39.5 26.8,41.3 29.3,44.6 24,43.3 "/>
      </svg></span>
      <span class="site-title"><a class="site-title-href" href="/blog/">
        jeffswt: the ac moments
      </a></span>
    </div>
  </div>
  <div class="site-content">
    <div class="blog-post" lang="zh">
      <div class="post-header">
        <h1 class="title">
          bzoj2145: 悄悄话
        </h1>
        <span class="tags">
          <a class="tag" href="/blog/archive/?q=Problems" target="_self">
            <i class="fa fa-tag"></i> Problems
          </a>
          <a class="tag" href="/blog/archive/?q=BZOJ" target="_self">
            <i class="fa fa-tag"></i> BZOJ
          </a>
          <a class="tag" href="/blog/archive/?q=Cryptography" target="_self">
            <i class="fa fa-tag"></i> Cryptography
          </a>
          <a class="tag" href="/blog/archive/?q=Fiddling" target="_self">
            <i class="fa fa-tag"></i> Fiddling
          </a>
        </span>
        <span class="date" title="01:42:45 | 28 February, 2017">
          28 February, 2017
        </span>
      </div>
      <div class="post-content">
        <h2 id="description">Description</h2>
<p>在这个有话不直说的年代, 密码学越来越被广泛接受. 我们引用经典的 “凯撒密码”. 在英文中, 凯撒加密只对 <span class="math inline">\(26\)</span> 个字母生效 (分大小写) 我们按照 a 到 z 来排字母. 凯撒加密的原理就是把原文的每一个字母都按顺序往后移 <span class="math inline">\(K\)</span> 位. 这个 <span class="math inline">\(K\)</span> 将被作为密钥. (‘a’ 往后移变成 ‘b’, ‘z’ 往后移会变成 ‘a’) , 其中 <span class="math inline">\(0 \leq K \leq 25\)</span>. 现在给出一系列用凯撒 加密的英文句子, 请你编写程序逐句翻译. 也就是说, 请你确定一个密钥, 使得解码以后的文字最符合英文的规则与规范. 数据保证存在唯一的解码方案, 使得明码是完全可以分辨的 英文句子.</p>
<h2 id="input">Input</h2>
<p>输入一定包括 <span class="math inline">\(10\)</span> 行每一行都是用同一密钥加密的英文.</p>
<h2 id="output">Output</h2>
<p>输出 <span class="math inline">\(10\)</span> 行, 为解密结果. 不允许格式上有任何不同.</p>
<!-- More -->
<h2 id="sample-input">Sample Input</h2>
<pre><code>Welcome to the test. This is the 1st sample test case.
Vdkbnld sn sgd sdrs. Sghr hr sgd 2mc rzlokd sdrs bzrd.
Welcome to the test. This is the 3rd sample test case.
Nvctfdv kf kyv kvjk. Kyzj zj kyv 4ky jrdgcv kvjk trjv.
Govmywo dy dro docd. Drsc sc dro 5dr ckwzvo docd mkco.
Nvctfdv kf kyv kvjk. Kyzj zj kyv 6ky jrdgcv kvjk trjv.
Jrypbzr gb gur grfg. Guvf vf gur 7gu fnzcyr grfg pnfr.
Ucjamkc rm rfc rcqr. Rfgq gq rfc 8rf qyknjc rcqr ayqc.
Ckriusk zu znk zkyz. Znoy oy znk 9zn ygsvrk zkyz igyk.
Xfmdpnf up uif uftu. Uijt jt uif mbtu tbnqmf uftu dbtf.</code></pre>
<h2 id="sample-output">Sample Output</h2>
<pre><code>Welcome to the test. This is the 1st sample test case.
Welcome to the test. This is the 2nd sample test case.
Welcome to the test. This is the 3rd sample test case.
Welcome to the test. This is the 4th sample test case.
Welcome to the test. This is the 5th sample test case.
Welcome to the test. This is the 6th sample test case.
Welcome to the test. This is the 7th sample test case.
Welcome to the test. This is the 8th sample test case.
Welcome to the test. This is the 9th sample test case.
Welcome to the test. This is the last sample test case.</code></pre>
<h2 id="data-range">Data Range</h2>
<p>数据将从不同的方面考察. 请尽量保证程序的准确性.</p>
<p>每一行长度不会太短 (不少于 <span class="math inline">\(3\)</span> 个单词的完整句). 没有全角字符和其他语言符号, 可能包含半角空格和标点.</p>
<p>单个测试点不超过 5kB.</p>
<h2 id="explanation">Explanation</h2>
<p>这道题用后边想都知道是密码学......</p>
<p>也就是说, 考虑到英文字母中最常出现的 <span class="math inline">\(8\)</span> 个字符是 “a, s, i, n, t, o, e, r”, 最不常出现的是 “z, x, p, b, j, k, q” (只需旁边几块钱, hzwer 说的);</p>
<p>然后再考虑一些特判和常见单词就可以了.</p>
<p>但是这毕竟是一道玄学题...... 所以如果用的词汇表略大还会搞成 WA~</p>
<p>然后就只能膜了~</p>
<h2 id="source-code">Source Code</h2>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">
<span class="ot">#include &lt;iostream&gt;</span>
<span class="ot">#include &lt;cstdlib&gt;</span>
<span class="ot">#include &lt;cstdio&gt;</span>
<span class="ot">#include &lt;cstring&gt;</span>

<span class="ot">#define raise_condition() while (true) printf("BREAKPOINT</span><span class="er">\</span><span class="ot">n")</span>
<span class="kw">using</span> <span class="kw">namespace</span> std;
<span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> lli;
<span class="dt">const</span> <span class="dt">int</span> maxn = <span class="dv">1010</span>;

string patr[<span class="dv">20</span>] = {
    <span class="st">"we"</span>, <span class="st">"you"</span>, <span class="st">"it"</span>, <span class="st">"he"</span>, <span class="st">"they"</span>,
    <span class="st">"is"</span>, <span class="st">"are"</span>, <span class="st">"was"</span>,
    <span class="st">"the"</span>, <span class="st">"a"</span>,
    <span class="st">"on"</span>, <span class="st">"in"</span>, <span class="st">"of"</span>, <span class="st">"to"</span>,
    <span class="st">"do"</span>, <span class="st">"if"</span>, <span class="st">"and"</span>, <span class="st">"but"</span>, <span class="st">"how"</span>,
    <span class="st">"all"</span>
}; <span class="co">// Common vocabulary</span>
<span class="dt">char</span> match1[<span class="dv">8</span>] = {
    <span class="st">'a'</span>, <span class="st">'s'</span>,<span class="st">'i'</span>,<span class="st">'n'</span>, <span class="st">'t'</span>,<span class="st">'o'</span>, <span class="st">'e'</span>,<span class="st">'r'</span>
}; <span class="co">// Most occured letters</span>
<span class="dt">char</span> match2[<span class="dv">4</span>] = {
    <span class="st">'j'</span>, <span class="st">'q'</span>, <span class="st">'x'</span>, <span class="st">'z'</span>
}; <span class="co">// Least occured letters</span>
<span class="dt">int</span> weight[<span class="dv">26</span>]; <span class="co">// Weight for indifidual characters</span>

<span class="dt">bool</span> is_lower(<span class="dt">char</span> ch) {
    <span class="kw">return</span> ch &gt;= <span class="st">'a'</span> &amp;&amp; ch &lt;= <span class="st">'z'</span>; }
<span class="dt">bool</span> is_upper(<span class="dt">char</span> ch) {
    <span class="kw">return</span> ch &gt;= <span class="st">'A'</span> &amp;&amp; ch &lt;= <span class="st">'Z'</span>; }
<span class="dt">bool</span> is_letter(<span class="dt">char</span> ch) {
    <span class="kw">return</span> is_lower(ch) || is_upper(ch); }

string right_shift(string str, <span class="dt">int</span> distance = <span class="dv">1</span>)
{
    string ans = <span class="st">""</span>;
    <span class="kw">for</span> (<span class="dt">unsigned</span> <span class="dt">int</span> i = <span class="dv">0</span>; i &lt; str.length(); i++) {
        <span class="kw">if</span> (str[i] &gt;= <span class="st">'a'</span> &amp;&amp; str[i] &lt;= <span class="st">'z'</span>)
            ans += (str[i] - <span class="st">'a'</span> + distance + <span class="dv">26</span>) % <span class="dv">26</span> + <span class="st">'a'</span>;
        <span class="kw">else</span>
            ans += str[i];
    }
    <span class="kw">return</span> ans;
}

<span class="dt">int</span> eval_weight(string str, <span class="dt">int</span> type[])
{
    <span class="co">// Now we have a string with only lower-case letters</span>
    <span class="dt">int</span> length = str.length();
    <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">100</span>; i++)
        str += <span class="st">" "</span>;
    <span class="dt">int</span> sum = <span class="dv">0</span>;
    <span class="co">// Letter judifications and special letters</span>
    <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; length; i++)
        <span class="kw">if</span> (is_lower(str[i])) {
            sum += weight[str[i] - <span class="st">'a'</span>];
            <span class="kw">if</span> (str[i] == <span class="st">'i'</span> &amp;&amp; type[i] == <span class="dv">1</span>)
                sum += <span class="dv">5</span>;
        }
    <span class="co">// Checking vocabularies</span>
    <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; length; i++) {
        <span class="kw">if</span> (i &lt;= <span class="dv">0</span> || type[i - <span class="dv">1</span>] == <span class="dv">2</span>) {
            <span class="kw">for</span> (<span class="dt">int</span> k = <span class="dv">0</span>; k &lt; <span class="dv">20</span>; k++) {
                string nstr = patr[k];
                <span class="dt">int</span> nlen = nstr.length();
                <span class="co">// Incompatible length</span>
                <span class="kw">if</span> (i + nlen &gt;= length)
                    <span class="kw">continue</span>;
                <span class="co">// Not a whole word</span>
                <span class="kw">if</span> (type[i + nlen] != <span class="dv">2</span>)
                    <span class="kw">continue</span>;
                <span class="co">// Finding match</span>
                <span class="dt">bool</span> found = <span class="kw">true</span>;
                <span class="kw">for</span> (<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; nlen; j++)
                    <span class="kw">if</span> (str[i + j] != nstr[j]) {
                        found = <span class="kw">false</span>;
                        <span class="kw">break</span>;
                    }
                <span class="co">// Failure in finding</span>
                <span class="kw">if</span> (!found)
                    <span class="kw">continue</span>;
                <span class="co">// One correct string matches</span>
                sum += <span class="dv">4</span>;
                <span class="kw">break</span>;
            }
        }
    }
    <span class="co">// Returning.</span>
    <span class="kw">return</span> sum;
}

<span class="dt">int</span> T;
<span class="dt">int</span> type[maxn];

<span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span>** argv)
{
    <span class="co">// Initializing weight</span>
    memset(weight, <span class="dv">0</span>, <span class="kw">sizeof</span>(weight));
    <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">8</span>; i++)
        weight[match1[i] - <span class="st">'a'</span>] += <span class="dv">1</span>;
    <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">4</span>; i++)
        weight[match2[i] - <span class="st">'a'</span>] -= <span class="dv">2</span>;
    <span class="co">// Reading data</span>
    T = <span class="dv">10</span>;
    <span class="kw">for</span> (<span class="dt">int</span> idx = <span class="dv">1</span>; idx &lt;= T; idx++) {
        <span class="co">// Clearing and reading</span>
        memset(type, <span class="dv">0</span>, <span class="kw">sizeof</span>(type));
        string str[<span class="dv">26</span>];
        getline(cin, str[<span class="dv">0</span>]);
        <span class="dt">int</span> length = str[<span class="dv">0</span>].length();
        <span class="co">// Retrieving type data</span>
        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; length; i++) {
            <span class="kw">if</span> (is_upper(str[<span class="dv">0</span>][i])) {
                type[i] = <span class="dv">1</span>;
                str[<span class="dv">0</span>][i] += <span class="st">'a'</span> - <span class="st">'A'</span>;
            } <span class="kw">else</span> <span class="kw">if</span> (is_lower(str[<span class="dv">0</span>][i])) {
                type[i] = <span class="dv">0</span>;
            } <span class="kw">else</span> <span class="kw">if</span> (str[<span class="dv">0</span>][i] == <span class="st">'</span><span class="ch">\'</span><span class="st">'</span>) {
                type[i] = <span class="dv">-1</span>;
            } <span class="kw">else</span> {
                type[i] = <span class="dv">2</span>;
            }
        }
        <span class="co">// Shifting characters</span>
        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt; <span class="dv">26</span>; i++)
            str[i] = right_shift(str[<span class="dv">0</span>], i);
        <span class="co">// Evaluation</span>
        <span class="dt">int</span> maxx = <span class="dv">0</span>,
            res = <span class="dv">0</span>;
        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="dv">26</span>; i++) {
            <span class="dt">int</span> tres = eval_weight(str[i], type);
            <span class="kw">if</span> (tres &gt;= maxx) {
                maxx = tres;
                res = i;
            }
        }
        <span class="co">// Output string;</span>
        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; length; i++)
            <span class="kw">if</span> (type[i] == <span class="dv">1</span>)
                str[res][i] += <span class="st">'A'</span> - <span class="st">'a'</span>;
        <span class="kw">for</span> (<span class="dt">unsigned</span> <span class="dt">int</span> i = <span class="dv">0</span>; i &lt; str[res].length(); i++)
            printf(<span class="st">"</span><span class="ch">%c</span><span class="st">"</span>, str[res][i]);
        printf(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>);
    }
    <span class="kw">return</span> <span class="dv">0</span>;
}</code></pre></div>

      </div>
      <div class="post-footer">
        <span class="share">
          <i class="fa fa-share-alt"></i>share to:
          <a href="https://www.facebook.com/sharer/sharer.php?u=https://jeffswt.org//blog/bzoj2145/"><i class="fa fa-facebook"></i>facebook</a>
          <a href="https://twitter.com/intent/tweet?text=https://jeffswt.org//blog/bzoj2145/"><i class="fa fa-twitter"></i>twitter</a>
          <a href="https://plus.google.com/share?url=https://jeffswt.org//blog/bzoj2145/"><i class="fa fa-google-plus"></i>google+</a>
          <a href="https://www.reddit.com/submit?url=https://jeffswt.org//blog/bzoj2145/"><i class="fa fa-reddit"></i>reddit</a>
        </span>
        <hr />
      </div>
    </div>
    <div id="comments-section" data-id="bzoj2145">
    </div>
  </div>
  <div class="page-footer">
    <center><span class="copyright">
      &copy; 2017 jeffswt, all rights reserved.
    </span></center>
  </div>

  <script type="text/javascript" src="/assets/katex/katex.js"></script>
  <script type="text/javascript" src="/assets/katex/contrib/auto-render.js"></script>
  <script type="text/javascript" src="/assets/gitment/gitment.js"></script>
  <script type="text/javascript" src="/assets/main.js"></script>

  <div hidden="hidden">
    <script type="text/javascript" src="https://s11.cnzz.com/z_stat.php?id=1261583208&web_id=1261583208"></script>
  </div>
</body>
</html>
